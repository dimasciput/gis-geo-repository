<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8"/>
    <title>Add a vector tile source</title>
    <meta name="viewport"
          content="initial-scale=1,maximum-scale=1,user-scalable=no"/>
    <script src="https://unpkg.com/maplibre-gl@2.1.9/dist/maplibre-gl.js"></script>
    <link href="https://unpkg.com/maplibre-gl@2.1.9/dist/maplibre-gl.css"
          rel="stylesheet"/>
    <style>
        body {
            margin: 0;
            padding: 0;
            font-family: "Roboto", "Lucida Grande", Verdana, Arial, sans-serif;
        }
        #map {
            position: absolute;
            top: 0;
            bottom: 0;
            width: 100%;
        }
        .dataset {
            background-color: rgba(248, 248, 248, 0.47);
            z-index: 999;
            position: absolute;
            padding: 5px;
        }
    </style>
</head>
<body>
<div id="map"></div>
<div class="dataset">
    Dataset : {{ dataset.label }} <div id="zoom"></div>
</div>
<script>
    var map = new maplibregl.Map({
        container: 'map',
        style:
            'https://api.maptiler.com/maps/hybrid/style.json?key=get_your_own_OpIi9ZULNHzrESv6T2vL',
        zoom: 5,
        center: {{ center.coordinates }}
    });

    var nav = new maplibregl.NavigationControl();
    map.addControl(nav, 'top-right');

    document.getElementById('zoom').innerHTML = 'Zoom : ' + map.getZoom();

    map.on('zoom', () => {
      document.getElementById('zoom').innerHTML = 'Zoom : ' + map.getZoom().toFixed(2);
    });

    map.on('load', function () {
        map.addSource('{{ dataset.label }}', {
          'type': 'vector',
          "tiles": ["{{ layer_tiles_base_url }}{{ dataset.vector_tiles_path }}&token={{ user.auth_token }}"],
          "tolerance": 0
        });

      {% for layer_config in layers_configs %}
        map.addLayer({{ layer_config | safe }})
      {% endfor %}
{##}
{#        map.addLayer({#}
{#            "id": "region-text",#}
{#            "source": "{{ dataset.label }}",#}
{#            "source-layer": "Level-1",#}
{#            "type": "symbol",#}
{#            "minzoom": 4,#}
{#            "maxzoom": 6,#}
{#            "layout": {#}
{#                "text-field": '{label}',#}
{#                "text-font": [#}
{#                    "Open Sans"#}
{#                ],#}
{#                "text-size": {#}
{#                    "stops": [#}
{#                        [#}
{#                            12,#}
{#                            12#}
{#                        ],#}
{#                        [#}
{#                            13,#}
{#                            13#}
{#                        ]#}
{#                    ]#}
{#                },#}
{#                'text-variable-anchor': ['top', 'bottom', 'left', 'right'],#}
{#                'text-radial-offset': 0.5,#}
{#                'text-justify': 'auto',#}
{##}
{#            },#}
{#            "paint": {#}
{#                "text-color": "rgb(255,255,255)",#}
{#                "text-halo-color": "rgb(96,1,218)",#}
{#                "text-halo-width": 0.8#}
{#            },#}
{#            "symbol-spacing": 500,#}
{#        });#}
{##}
{##}
{#        map.addLayer({#}
{#            "id": "district-text",#}
{#            "source": "{{ dataset.label }}",#}
{#            "source-layer": "Level-2",#}
{#            "type": "symbol",#}
{#            "minzoom": 6,#}
{#            "maxzoom": 20,#}
{#            "layout": {#}
{#                "text-field": ['get', 'label'],#}
{#                "text-font": [#}
{#                    "Open Sans Italic"#}
{#                ],#}
{#                "text-size": {#}
{#                    "stops": [#}
{#                        [#}
{#                            12,#}
{#                            12#}
{#                        ],#}
{#                        [#}
{#                            13,#}
{#                            13#}
{#                        ]#}
{#                    ]#}
{#                },#}
{#                "text-anchor": "center",#}
{#                "text-justify": "center"#}
{#            },#}
{#            "paint": {#}
{#                "text-color": "rgb(255,255,255)",#}
{#                "text-halo-color": "rgb(33,138,138)",#}
{#                "text-halo-width": 1#}
{#            },#}
{#            "symbol-spacing": 500,#}
{#            "text-anchor": "center"#}
{#        });#}
    });
</script>

</body>
</html>